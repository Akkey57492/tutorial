# 基本
Botを作るうえでの基本的なコードを学びましょう。<br>ここの知識で最低限のBotを作成することができます。

## 土台
まずは、何もしないからのコードを書きましょう
```py
import discord

client = discord.Client()

client.run("")
```
これは、前回の1番で紹介したコードです。
このコードに付け足していきます。

## イベント受信
Clientでは、イベントの受信をしてそれを処理することができます。<br>
ここではイベントの種類、受信方法を紹介します。

### on_ready()
on_readyのイベントは、Botがログインされたときに実行されるイベントです。

### on_message()
on_messageイベントは、誰かがメッセージを送信したときに実行されるイベントです。<br>
関数には、メッセージの情報が格納されます。<br>
例: message.content = メッセージの内容を取得

### コード
イベントは
```py
@client.event
```
の次に
```py
async def ここ:
```
へ書きます。<br>
on_readyイベントを使う場合は
```py
@client.event
async def on_ready():
```
となります。<br>
これは、client変数にdiscord.Client()インスタンスを指定した後に書きます。<br>
そのため最終的なコードは
```py
import discord

client = discord.Client()

@client.event
async def on_ready():
  # 処理
  
client.run("")
```
となります。<br>
では、ログインするときにprintする文です。<br>
コードは以下となります。
```py
import discord

client = discord.Client()

@client.event
async def on_ready():
  print("Logged In")
  
client.run("")
```
Botにログインしたら、on_ready関数が実行されてprintされます。<br>
(printの引数に「Logged In」を指定しているため「Logged In」と出力されます)

## 基本
では、メッセージの受信もしてみましょう。<br>
追加のイベントは、前のイベントのさらに下に書きます。
```py
@client.event
async def on_ready():
  print("Logged In")

@client.event
async def on_message(message):
  # 処理
```
ということになります。<br>
このon_messageイベントの関数の引数には、messageが定義されています。<br>
この第1引数にはメッセージの情報が格納されます。<br>
例: ID / Content / Bot<br><br>
では、メッセージをオウム返しするコードを書いてみましょう。<br>
の前に、必ず入れなければいけないコードがあります。
```py
if message.author.bot:
  return
```
このコードです。<br>
このコードを入れないと、Bot自体がBot自体のワードに反応してループするということが起きます。<br>
なので、Botには反応しないようにします。<br>
ここで出てきている
```
message.author.bot
```
は...メッセージを送信したユーザーがBotか...ということです。<br>
```
return
```
は...関数の返り値を定義する...ということです。<br>
message.author.botでbotか判断し、returnで無視しています。<br>
(それ以降の処理を行わないようにしている)<br>
では、おうむ返しのコードを作っていきましょう。<br>
まず、現在のコードです。
```py
import discord

client = discord.Client()

@client.event
async def on_ready():
  print("Logged In")

@client.event
async def on_message(message):
  if message.author.bot:
    return
    
client.run("")
```
if分のbot判別用コードのみあります。<br>
その下にコードを付け足していきます。<br>
メッセージの内容は
```
message.content
```
で取得することができます。<br>
そして、メッセージが送られたチャンネルを取得する必要があります。<br>
(メッセージが送られたチャンネルでおうむ返しするために)<br>
チャンネルの取得は
```
message.channel
```
となります。<br>
そして、メッセージの送信はsend関数でできます。<br>
send関数は第1引数に内容を指定することができます。<br>
つまり全体のコードは
```py
import discord

client = discord.Client()

@client.event
async def on_ready():
  print("Logged In")

@client.event
async def on_message(message):
  if message.author.bot:
    return
  await message.channel.send(message.content)
    
client.run("")
```
になります。<br>
send関数の前に、message.channelを指定することでチャンネルを指定しています。<br>
事前にidでチャンネルを指定して、変数定義して、その変数をsend関数に使うとidのチャンネルにメッセージを送信することもできます。<br>
そして、第1引数にmessage.contentを指定しているためメッセージの内容をそのまま取得して、送信されることがわかります。

## 返信
おうむ返しはできました。<br>
次はコマンドも作ってみましょう。<br>
message.contentをif分で比較後、処理を書けばできます。
```py
import discord

client = discord.Client()

@client.event
async def on_ready():
  print("Logged In")

@client.event
async def on_message(message):
  if message.author.bot:
    return
  await message.channel.send(message.content)
    
client.run("")
```
現在のコードはこれです。<br>
いったんおうむ返しのコードを消します。
```py
import discord

client = discord.Client()

@client.event
async def on_ready():
  print("Logged In")

@client.event
async def on_message(message):
  if message.author.bot:
    return
    
client.run("")
```
そして、if文でmessage.contentの内容を比較します。
```py
if message.content == "!test"
```
このif文で、比較ができます。<br>
「==」で「○○だったら」ということができます。<br>
あとはif文内に処理をコマンド実行時の処理に変えるだけです。<br>
試しに、「!test」で「テスト」と返事するコードを作ってみます。
```py
import discord

client = discord.Client()

@client.event
async def on_ready():
  print("Logged In")

@client.event
async def on_message(message):
  if message.author.bot:
    return
  if message.content == "!test":
    await message.channel.send("テスト")
    
client.run("")
```
if文で比較後、send関数でメッセージを送信してあげれば実装できます。<br>
違う点は、第1引数を自分で指定していること。<br>
そして、if文を使っていることです。<br>
これで、実装は完了です。
### 量産
量産してみましょう。<br>
@client.eventを増やしてはいけません。<br>
同じ関数内にif文を作りましょう。<br>
現在のコードは
```py
import discord

client = discord.Client()

@client.event
async def on_ready():
  print("Logged In")

@client.event
async def on_message(message):
  if message.author.bot:
    return
  if message.content == "!test":
    await message.channel.send("テスト")
    
client.run("")
```
です。<br>
この`if message.content == "!test":`のif文の下にさらに`elif`文を使ってコードを書きます。<br>
if = もし○○なら...<br>
elif = でなく、○○であれば...<br>
となります。<br>
試しに`!ping`と打ったら`pong`と帰ってくる文を書いてみましょう。
```py
import discord

client = discord.Client()

@client.event
async def on_ready():
  print("Logged In")

@client.event
async def on_message(message):
  if message.author.bot:
    return
  if message.content == "!test": # もし○○なら
    await message.channel.send("テスト")
  elif message.content == "!ping": # そうじゃなく、○○だったら
    await message.channel.send("pong")
    
client.run("")
```
となります。<br>
あとはこれを量産すれば大丈夫です。
### エラー
コマンドが存在しないときのエラーもつけることができます。<br>
elif文を量産して、一番下のelifにさらにelseを付け足します。<br>
elseは`もし当てはまらなかったら`という処理です。<br>
つまり、ifやelifの内容が当てはまらなければelseの内容が実行されます。
```py
import discord

client = discord.Client()

@client.event
async def on_ready():
  print("Logged In")

@client.event
async def on_message(message):
  if message.author.bot:
    return
  if message.content == "!test": # もし○○なら
    await message.channel.send("テスト")
  elif message.content == "!ping": # そうじゃなく、○○だったら
    await message.channel.send("pong")
    
client.run("")
```
現在のコードがこれです。<br>
一番したのelifにさらにelseを付け足してみます。<br>
そして、「コマンドが存在しません」と表示させてみます。
```py
import discord

client = discord.Client()

@client.event
async def on_ready():
  print("Logged In")

@client.event
async def on_message(message):
  if message.author.bot:
    return
  if message.content == "!test": # もし○○なら
    await message.channel.send("テスト")
  elif message.content == "!ping": # そうじゃなく、○○だったら
    await message.channel.send("pong")
  else: # もしifまたはelifに当てはまらなかったら
    await message.channel.send("コマンドが存在しません")
    
client.run("")
```
このようなコードになります。<br>
elseは何個も定義することはできません。<br>
1つのifに1つまでです。
